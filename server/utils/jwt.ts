import jwt, { SignOptions } from 'jsonwebtoken';

type Payload = {
  sub: number;
};

const privateKeyHash =
  'LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb1FJQkFBS0NBUUJtYXF2SVErTXFoUnFmcjVoWm53eFpORkltYWtYMTdqSVNOc2FuV09ndUVZUmpva3BECnNyaUZ5RC9DSVBwWlFZR3BBZG1sUGpWUmR6czBwODIxR2RXdUkySFc0Vm9YNWZHUC9ZTnZVMm1hb3RSd0M1ZU4KMHNWRnhnTlpYMmVUZlZNTm5VL1JIL0JMcitBbHYwckpIdFRtREJvb0dQZDRRaHBkVDdkcXRxd2x6aTlXdWp6Mgo1OFU5Ty9yUUZXaDkvRXRuUGhqNC9Oa3FLYVF3UDVhVUtsTWtndWlSRWoySjA1U0V4Smkwc09tNjVRVCtES2pUClpsODFmUkdrZngyU0MrN3ppRkRmV2RQK2FRUlRYWDQzOGFCRTVLaHFLbUg1Tm9NOFBoeFhTS2tRQUhPdWNFcy8KckJJSTlydFp6UDJONTNXNTJvb04xcEhOY1RIT2N2VHpoLzJyQWdNQkFBRUNnZ0VBSWVtdWlqallqdXJXUHd4QgpFV1FXRGEvQ2lBL21yS0c4R01Ya2orTmp0bVY4aGhWbUsvYVJIVk9Lc1RpRVRXdmdpRnNoZTVNV3lxd0ZnZEVTCno2WUhXSXRFeVllRGNxaGtqYjV2ZUR5Um1tL1NrbXQwT3JVUk42SnkxM1E4OHR5cjFMVkRpY2JlcGVGT0FwSE8KTEx5MTJKc25TaUhDU0NMellmU1VrcFI4ZW1QWGVNc29xNUhzZm1OaEFNWFR0ckZ3VGc2RldKRjBSUjFiMEl0Swo3bE5rc0M4Q1ZEc3BVemtEZmtIR0xCSGFhbXFxUjJPQVFCZ20zUGowMjN1ZWoyL2daME1HMTF3UG40ajNVdnF5Cmo1eS9CaXdHOVlkZXBOTCsvK0tQczNONkRJc2RaUDQ2dmw3ZmhhUm94bGZiY0FDUEZGTWg5K2Vqc3FOR2Q5TUoKSnlCejZRS0JnUURGVUx2UUR4aG1tV1MxS0F0dVNiaXZyRXpnQVdVRUwweHZQaERjWThaZ2lQTk9NUjFFVGRQNwpJWmw3RnFtWEJmUXNTbE9ham9qTnBNR3UvZzFwVE40cHlYTytPT21CcUJpL1k1U1liWnViN1VRK1pTZ0xHNW81Cm1DTVc5MmlVcUNRWG1ZVWtva2l6eC93c3h1cEltRk1MU29lQWpsWUpVU0l3bGdxTEdUZDY3UUtCZ1FDRTRJSWgKUjdYTE1JR1RpVStEVzYvVXlQVno2Z2Q5VXVVM3RTVXFsNmVqRGthS1Fmbkt0eW5ueS9xWFFUeEwyWWgvSGdtSgplbm9LV2FmRSszSUx0K3VJbkQ1aERXTy9Ib1VoeFhoQ3g3Q2VyZXMzSlVyMUxNdE1yNXpOSUxPeDFSS1cvanpxCnRFRXh4ak1YOHZ4YS85ZkpJOXZCM2p2d3FLMGhHd282bmU2UDl3S0JnRFdIOWF3NHJESUpvNXpTUkdlamNJdVkKZnpLMnJpVTRmOUFlVW95NE5QV3pzZTZndklQdmFYZFVZa05XbnFQdVpaUXVoZ2dFYTNEL0pkekg1L09OZXloegpFd2VrZ1JVLytaYlMrVmx4UXlwR2NLRk02RlE3Sk5oRFFpSFU5WFovTjJ0L3B2T05ZNVFDeVpPTVU3dG1PQUYwCk10Ylp4dFc0UVVKVk1uOFNWRTd4QW9HQVgzU0pCeTlrd1pzTyt0WGhjUlFrdEUvSlJJUVM3VXpucmFWTUZkVHMKY0k2SXpqbW5JS0dFVVNpUDFLamdqL3l0dWVQeUpmaitRd0UxTEtVVndLVlhac1FYYTlFYW51bGw2bVRaaDkrOApXY0hHLzg2aWtvNmpYV3VxMFJGMUJZTnozMVMwbmtidnJyb2JhbEQ4U01NU1dVU1JVaXc4RXg2WmdQYlQybGdxClVQRUNnWUJVV1p2LzFkNUpxc2FTSlNrSmxLRFBUSHgzODdzU2xlTGhBUkFVeHJoRVlTQnl6RHNuRDE4ckVOd2EKVEU1dWlIWlhaRWVOb20xMGUxYzVNNWRRRVR3Uk1sWTFTbXNpQmZmVEVucHdYMytBTE10dTdweWt2K0Z4Q3JZYwpDQlVNWFEwc2pnNm9mMWdPd3BmbCtNd3ltd3Y3YTFjWExPTHB4a01aU1NnT2g4QmEydz09Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0t';
const publicKeyHash =
  'LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklUQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FRNEFNSUlCQ1FLQ0FRQm1hcXZJUStNcWhScWZyNWhabnd4WgpORkltYWtYMTdqSVNOc2FuV09ndUVZUmpva3BEc3JpRnlEL0NJUHBaUVlHcEFkbWxQalZSZHpzMHA4MjFHZFd1CkkySFc0Vm9YNWZHUC9ZTnZVMm1hb3RSd0M1ZU4wc1ZGeGdOWlgyZVRmVk1OblUvUkgvQkxyK0FsdjBySkh0VG0KREJvb0dQZDRRaHBkVDdkcXRxd2x6aTlXdWp6MjU4VTlPL3JRRldoOS9FdG5QaGo0L05rcUthUXdQNWFVS2xNawpndWlSRWoySjA1U0V4Smkwc09tNjVRVCtES2pUWmw4MWZSR2tmeDJTQys3emlGRGZXZFArYVFSVFhYNDM4YUJFCjVLaHFLbUg1Tm9NOFBoeFhTS2tRQUhPdWNFcy9yQklJOXJ0WnpQMk41M1c1Mm9vTjFwSE5jVEhPY3ZUemgvMnIKQWdNQkFBRT0KLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0t';

export const signJwt = (payload: Payload, options: SignOptions = {}) => {
  const privateKey = Buffer.from(privateKeyHash, 'base64');

  return jwt.sign(payload, privateKey, {
    ...(options && options),
    algorithm: 'RS256',
  });
};

export const verifyJwt = (token: string) => {
  try {
    const publicKey = Buffer.from(publicKeyHash, 'base64');

    return jwt.verify(token, publicKey) as unknown as Payload;
  } catch (error) {
    return null;
  }
};
